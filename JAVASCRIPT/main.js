const products = [
    {
        "id":1,
        "name":"Nước Hoa Creed Aventus",
        "price": 3000000,
        "image":"/IMGSP/Creed.jpg"
    },
    {
        "id":2,
        "name":"Nước Hoa Dior Homme Intense",
        "price": 3000000,
        "image":"/IMGSP/Dior 2.jpg"
    },
    {
        "id":3,
        "name":"Nước Hoa Dior J'adore Eau De Parfum",
        "price": 3000000,
        "image":"/IMGSP/Dior.jpg"
    },
    {
        "id":4,
        "name":"Nước Hoa Jean Paul Gaultier Classique Eau De",
        "price": 3000000,
        "image":"/IMGSP/Jean Paul Gaultier Classique.webp"
    }, 
    {
        "id":5,
        "name":"Nước Hoa Jean Paul Gaultier Le Male",
        "price": 3000000,
        "image":"/IMGSP/Jean Paul Gaultier.jpg"
    },
    {
        "id":6,
        "name":"Nước Hoa Kilian Good Girl Gone Bad",
        "price": 3000000,
        "image":"/IMGSP/Kilian.jpg"
    },
    {
        "id":7,
        "name":"Nước Hoa Nam Argos Brivido Della",
        "price": 3000000,
        "image":"/IMGSP/Nam - argos brivido.webp"
    },
    {
        "id":8,
        "name":"Nước Hoa Nam Armaf Club De Nuit",
        "price": 3000000,
        "image":"/IMGSP/Nam - armaf club.webp"
    },
    {
        "id":9,
        "name":"Nước Hoa Nam Bently Intense",
        "price": 3000000,
        "image":"/IMGSP/Nam - bently.webp"
    },
    {
        "id":10,
        "name":"Nước Hoa Nam Burberry Hero Eau De Toilette",
        "price": 3000000,
        "image":"/IMGSP/Nam - burberry hero.webp"
    },
    {
        "id":11,
        "name":"Nước Hoa Nam Chanel Bleu De Chanel Parfum ",
        "price": 3000000,
        "image":"/IMGSP/Nam - chanel bleu.webp"
    },
    {
        "id":12,
        "name":"Nước Hoa Nam Creed Royal Oud Eau De Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nam - creed royal.webp"
    },
    {
        "id":13,
        "name":"Nước Hoa Nam Giorgio Armani Acqua Di Gio",
        "price": 3000000,
        "image":"/IMGSP/Nam - di gio.webp"
    },
    {
        "id":14,
        "name":"Nước Hoa Nam Doir Sauvage Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nam - dior sauvage.webp"
    },
    {
        "id":15,
        "name":"Nước Hoa Nam Ermenegildo Zegna Essenze Indonesian Oud",
        "price": 3000000,
        "image":"/IMGSP/Nam - ermenegildo.webp"
    },
    {
        "id":16,
        "name":"Nước Hoa Nam Giorgio Armani Acqua di Giò Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nam - Giorgio.webp"
    },
    {
        "id":17,
        "name":"Nước Hoa Nam Gucci Guilty Pour Homme Eau De Pafum",
        "price": 3000000,
        "image":"/IMGSP/Nam - gucci guilty.webp"
    },
    {
        "id":18,
        "name":"Nước Hoa Nam Kilian Straight To Heaven",
        "price": 3000000,
        "image":"/IMGSP/Nam - kilian straight.webp"
    },
    {
        "id":19,
        "name":"Nước Hoa Nam Valentino Uomo Born In Roma Coral Fantasy",
        "price": 3000000,
        "image":"/IMGSP/Nam - valentino uomo.webp"
    },
    {
        "id":20,
        "name":"Nước Hoa Nam Viktor & Rolf Spicebomb Infrared",
        "price": 3000000,
        "image":"/IMGSP/Nam - Versace eros.webp"
    },
    {
        "id":21,
        "name":"Nước Hoa Nam Versace Eros Eau De Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nam - Versace eros.webp"
    },
    {
        "id":22,
        "name":"Nước Hoa Nam  Yves Saint Laurent YSL Y L'Elixir",
        "price": 3000000,
        "image":"/IMGSP/Nam - yves saint.webp"
    },
    {
        "id":23,
        "name":"Nước Hoa Nữ Armaf Club De Nuit",
        "price": 3000000,
        "image":"/IMGSP/Nu - Armaf club.webp"
    },
    {
        "id":24,
        "name":"Nước Hoa Nữ Carolina Herrera Good Girl Blush",
        "price": 3000000,
        "image":"/IMGSP/Nu - carolina herrera.webp"
    },
    {
        "id":25,
        "name":"Nước Hoa Nữ Coach Dreams",
        "price": 3000000,
        "image":"/IMGSP/Nu - coach dreams.webp"
    },
    {
        "id":26,
        "name":"Nước Hoa Nữ Dior Miss Dior Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nu - dior miss.webp"
    },
    {
        "id":27,
        "name":"Nước Hoa Nữ Zimaya Fatima Velvet Love Extrait De Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nu - zimaya fatima.webp"
    },
    {
        "id":28,
        "name":"Nước Hoa Nữ Yves Saint Laurent YSL Libre L'Absolu Platine",
        "price": 3000000,
        "image":"/IMGSP/Nu - Yves saint.webp"
    },{
        "id":29,
        "name":"Nước Hoa Nữ Parfums De Marly Delina",
        "price": 3000000,
        "image":"/IMGSP/Nu - parfums de marly.webp"
    },
    {
        "id":30,
        "name":"Nước Hoa Nữ Gucci Bloom Profumo Di Fiori Eau De Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nu - gucci bloom.webp"
    },
    {
        "id":31,
        "name":"Nước Hoa Nữ Gucci Flora Gorgeous Jasmin Eau De Parfum",
        "price": 3000000,
        "image":"/IMGSP/Nu - gucci flora.webp"
    },
    {
        "id":32,
        "name":"Nước Hoa Nữ Jean Paul Gaultier Scandal Le Parfum Eau De Parfum Intense",
        "price": 3000000,
        "image":"/IMGSP/Nu - jean paul.webp"
    },
    {
        "id":33,
        "name":"Nước Hoa Nữ Narciso Rodriguez Cristal",
        "price": 3000000,
        "image":"/IMGSP/Nu - narciso rodriguez.webp"
    },
    {
        "id":34,
        "name":"Nước Hoa Nữ Narciso Rodriguez Musc Noir Rose For Her",
        "price": 3000000,
        "image":"/IMGSP/Nu - narciso.webp"
    },
    {
        "id":35,
        "name":"Nước Hoa Nữ Prada La Femme By Prada For Women Eau De Parfum Spray",
        "price": 3000000,
        "image":"/IMGSP/Nu - Prada la femme.webp"
    },
    {
        "id":36,
        "name":"Nước Hoa Nữ Dior Miss Dior EDT Roller-Pearl Dạng Lăn",
        "price": 3000000,
        "image":"/IMGSP/Nu - roller pearl.webp"
    },
    {
        "id":37,
        "name":"Nước Hoa Nữ Valentino Donna Born In Roma Coral Fantasy",
        "price": 3000000,
        "image":"/IMGSP/Nu - valentino.webp"
    },
    {
        "id":38,
        "name":"Nước Hoa Nữ Moschino Toy 2 Bubble Gum Eau De Toilette",
        "price": 3000000,
        "image":"/IMGSP/NU - moschino toy 2.webp"
    },
    {
        "id":39,
        "name":"Nước Hoa Unisex Afnan Perfumes 9am",
        "price":3000000,
        "image":"/IMGSP/Un - afnan.webp"
    },
    {
        "id":40,
        "name":"Nước Hoa Unisex  Armaf Club De Nuit Untold",
        "price":3000000,
        "image":"/IMGSP/Un - armaf club.webp"
    },
    {
        "id":41,
        "name":"Nước Hoa Unisex Fragrance World Maison Vaporisateur Barakkat Rouge 540 Extrait De Parfum",
        "price":3000000,
        "image":"/IMGSP/Un - Fragrance.webp"
    },
    {
        "id":42,
        "name":"Nước Hoa Unisex Kilian Black Phantom Memento Mori",
        "price":3000000,
        "image":"/IMGSP/Un - kilian black.webp"
    },
    {
        "id":43,
        "name":"Nước Hoa Unisex Kilian Rolling In Love",
        "price":3000000,
        "image":"/IMGSP/Un - kilian rolling.webp"
    },
    {
        "id":44,
        "name":"Nước Hoa Unisex Lattafa Bade'e Al Oud Oud For Glory",
        "price":3000000,
        "image":"/IMGSP/Un - lattafa.webp"
    },
    {
        "id":45,
        "name":"Nước Hoa Unisex Afnan Perfumes 9am",
        "price":3000000,
        "image":"/IMGSP/Un - afnan.webp"
    },{
        "id":46,
        "name":"Nước Hoa Unisex Le Labo The Noir 29 Eau De Parfum",
        "price":3000000,
        "image":"/IMGSP/Un - le labo.webp"
    },
    {
        "id":47,
        "name":"Nước Hoa Unisex Louis Vuitton LV City Of Stars",
        "price":3000000,
        "image":"/IMGSP/Un - louis vuitton.webp"
    },
    {
        "id":48,
        "name":"Nước Hoa Unisex Maison Martin Margiela Replica On A Date Eau De Toilette",
        "price":3000000,
        "image":"/IMGSP/Un - maison martin.webp"
    },
    {
        "id":49,
        "name":"Nước Hoa Unisex Maison Martin Margiela Replica Lazy Sunday Morning",
        "price":3000000,
        "image":"/IMGSP/Un - margiela.webp"
    },
    {
        "id":50,
        "name":"Nước Hoa Unisex MCM Eau De Parfum Mini",
        "price":3000000,
        "image":"/IMGSP/Un - mcm eau.webp"
    },{
        "id":51,
        "name":"Nước Hoa Unisex Montale Black Aoud Night",
        "price":3000000,
        "image":"/IMGSP/Un - montable black.webp"
    },
    {
        "id":52,
        "name":"Nước Hoa Unisex Montale Intense Cafe Eau De Parfum",
        "price":3000000,
        "image":"/IMGSP/Un - montable cf.webp"
    },
    {
        "id":53,
        "name":"Nước Hoa Unisex Montale Starry Nights",
        "price":3000000,
        "image":"/IMGSP/Un - montable starry.webp"
    },
    {
        "id":54,
        "name":"Nước Hoa Unisex Roja Parfums Pour Homme Danger Parfum Cologne",
        "price":3000000,
        "image":"/IMGSP/Un - roja.webp"
    },
    {
        "id":55,
        "name":"Nước Hoa Unisex Tom Ford Ombré Leather",
        "price":3000000,
        "image":"/IMGSP/Un - Tom.webp"
    }
];
  let productInCart = localStorage.getItem('products') ? JSON.parse(localStorage.getItem('products')) : [];
  
  function saveToLocalStorage () {
    localStorage.setItem('products', JSON.stringify(productInCart));
  }
  
  //Index page
  function renderProducts () {
    let data = ``;
    products.map(value => {
      data += `
        <div class='col-3'>
          <div class='card'>
            <img src='${value.image}' class='card-img-top' alt=''>
            <div class='card-body'>
              <h5 class='card-title'>${value.name}</h5>
              <p class='card-text'>${value.price}</p>
              <button onclick='addToCart(${value.id})' class='btn btn-primary'>Add to cart</button>
            </div>
          </div>
        </div>
      `;
    });
    document.getElementById('products').innerHTML = data;
  }
  
  function addToCart (id) {
    let checkProduct = productInCart.some(value => value.id === id);
  
    if (!checkProduct) {
      let product = products.find(value => value.id === id);
      productInCart.unshift({
        ...product,
        quantity: 1
      });
      saveToLocalStorage();
      calculatorTotal();
    } else {
      let product = productInCart.find(value => value.id === id);
      let getIndex = productInCart.findIndex(value => value.id === id);
      productInCart[getIndex] = {
        ...product,
        quantity: ++product.quantity
      };
      saveToLocalStorage();
    }
  }
  
  function calculatorTotal () {
    document.getElementById('total').innerHTML = productInCart.length;
  }
  
  function indexLoadPage () {
    renderProducts();
    calculatorTotal();
  }
  
  //Cart page
  function renderProductsToTable () {
    let data = ``;
    productInCart.map((value, index) => {
      data += `
        <tr>
          <td>${value.name}</td>
          <td><img width='100' src='${value.image}' alt=''></td>
          <td>${value.price}</td>
          <td>
            <button onclick='plusQuantity(${index})' class='btn btn-secondary'>+</button>
            <span class='mx-2'>${value.quantity}</span>
            <button onclick='minusQuantity(${index}, ${value.quantity})' class='btn btn-secondary'>-</button>
          </td>
          <td>${(value.quantity * value.price.replace(/,/g, '')).toLocaleString()}</td>
          <td><button onclick='deleteProductInCart(${index})' class='btn btn-danger'>Delete</button></td>
        </tr>
      `;
    });
    document.getElementById('products-cart').innerHTML = data;
  }
  
  function plusQuantity (index) {
    productInCart[index] = {
      ...productInCart[index],
      quantity: ++productInCart[index].quantity
    };
    saveToLocalStorage();
    renderProductsToTable();
    totalMoney()
  }
  
  function minusQuantity (index, quantity) {
    if (quantity > 1) {
      productInCart[index] = {
        ...productInCart[index],
        quantity: --productInCart[index].quantity
      };
      saveToLocalStorage();
      renderProductsToTable();
      totalMoney()
    } else {
      alert('Quantity min is 1');
    }
  }
  
  function deleteProductInCart (index) {
    productInCart.splice(index, 1);
    saveToLocalStorage();
    renderProductsToTable();
    totalMoney()
  }
  
  function totalMoney () {
    if (productInCart !==[]) {
      let total = 0;
      for (let i = 0; i < productInCart.length; i++) {
        total += productInCart[i].quantity * productInCart[i].price.replace(/,/g, '');
      }
      document.getElementById("total-money").innerHTML = total.toLocaleString()
    }
  }
  
  function cartLoadPage () {
    renderProductsToTable();
    totalMoney();
  }